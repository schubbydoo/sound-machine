<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Worksheet - {{ profile.name }}</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        h1 { text-align: center; }
        .instructions {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 12px 8px; text-align: left; }
        th { background: #eee; }
        .answer-col { width: 60%; }
        .btn-col { width: 50px; text-align: center; }
        .hint-col { width: 30%; color: #666; font-style: italic; }
        
        @media print {
            .no-print { display: none; }
            .instructions { border: 1px solid #000; background: none; }
            th { background: none; border-bottom: 2px solid #000; }
        }
        
        .controls {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="no-print">
        <div class="controls">
            <div style="margin-bottom: 10px;">
                <button onclick="window.print()" style="font-size: 1.1em; padding: 5px 15px; cursor: pointer;">Print Worksheet</button>
                <button onclick="window.close()" style="font-size: 1.1em; padding: 5px 15px; cursor: pointer;">Close</button>
            </div>
            <div>
                 <label style="cursor: pointer;">
                    <input type="checkbox" id="cb-hint" checked onchange="toggleHint()"> Include Hint / Category
                </label>
            </div>
        </div>
    </div>

    <h1>{{ profile.name }}</h1>
    
    {% if profile.instructions %}
    <div class="instructions">
        <strong>Instructions:</strong> {{ profile.instructions }}
    </div>
    {% endif %}
    
    <table>
        <thead>
            <tr>
                <th class="btn-col">Button</th>
                <th class="hint-col">Hint / Category</th>
                <th class="answer-col">Your Answer</th>
            </tr>
        </thead>
        <tbody>
            {% for r in rows %}
            <tr>
                <td class="btn-col"><strong>{{ r.button_id }}</strong></td>
                <td class="hint-col">{{ r.hint or '' }}</td>
                <td class="answer-col"></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <script>
        function toggleHint() {
            const show = document.getElementById('cb-hint').checked;
            const cells = document.querySelectorAll('.hint-col');
            cells.forEach(c => c.style.display = show ? '' : 'none');
            
            // Adjust widths if hint is hidden to give more space to answer
            const answers = document.querySelectorAll('.answer-col');
            answers.forEach(c => c.style.width = show ? '60%' : '90%');
            
            localStorage.setItem('print_worksheet_hint', show);
        }

        // Load preference
        window.onload = function() {
            const stored = localStorage.getItem('print_worksheet_hint');
            if (stored !== null) {
                const shouldShow = stored === 'true';
                document.getElementById('cb-hint').checked = shouldShow;
                
                // Apply initial state
                const cells = document.querySelectorAll('.hint-col');
                cells.forEach(cell => cell.style.display = shouldShow ? '' : 'none');
                
                const answers = document.querySelectorAll('.answer-col');
                answers.forEach(c => c.style.width = shouldShow ? '60%' : '90%');
            }
        }
    </script>
</body>
</html>

